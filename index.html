<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ShadowGrid // Decentralized Future</title>
    
    <!-- P2P Stack 2026 -->
    <script src="cdn.jsdelivr.net"></script>
    <script src="cdn.jsdelivr.net"></script>
    <script src="cdn.jsdelivr.net"></script>

    <style>
        :root {
            --bg: #0e1621;
            --chat-bg: #17212b;
            --text: #f5f5f5;
            --accent: #2481cc;
            --hint: #708499;
            --success: #34c759;
            --card-bg: #1e2c3a;
        }
        body { background: var(--bg); color: var(--text); font-family: -apple-system, system-ui, sans-serif; margin: 0; padding: 20px; display: flex; flex-direction: column; align-items: center; }
        
        .container { width: 100%; max-width: 600px; background: var(--chat-bg); border-radius: 15px; overflow: hidden; box-shadow: 0 10px 40px rgba(0,0,0,0.5); }
        
        /* Header */
        .header { padding: 20px; background: var(--card-bg); text-align: center; border-bottom: 1px solid #000; }
        .header h1 { margin: 0; font-size: 22px; color: var(--accent); }
        .status { font-size: 11px; margin-top: 5px; color: var(--success); text-transform: uppercase; letter-spacing: 1px; }

        /* Content */
        .content { padding: 20px; }
        .post { background: var(--card-bg); padding: 15px; border-radius: 12px; margin-bottom: 20px; position: relative; }
        .post::before { content: ''; position: absolute; left: -5px; top: 20px; border-style: solid; border-width: 10px 10px 10px 0; border-color: transparent var(--card-bg) transparent transparent; }
        
        h2 { font-size: 18px; color: var(--accent); margin-top: 0; }
        p { font-size: 14px; line-height: 1.5; color: #e1e1e1; }
        ul { padding-left: 20px; font-size: 14px; color: var(--hint); }
        li { margin-bottom: 8px; }

        /* Roadmap */
        .roadmap { display: flex; flex-direction: column; gap: 10px; margin-top: 15px; }
        .step { display: flex; align-items: center; gap: 10px; font-size: 13px; padding: 8px; background: rgba(0,0,0,0.2); border-radius: 8px; }
        .step.done { border-left: 3px solid var(--success); }
        .step.next { border-left: 3px solid var(--accent); }

        /* Action Area */
        .download-zone { padding: 25px; background: var(--bg); text-align: center; border-top: 1px solid #232e3c; }
        .btn-dl { background: var(--accent); color: white; border: none; width: 100%; padding: 18px; border-radius: 12px; font-weight: bold; cursor: pointer; transition: 0.3s; font-size: 15px; }
        .btn-dl:hover { background: #288fde; }
        .btn-dl:disabled { background: #2c3b4a; color: var(--hint); cursor: not-allowed; }

        #console { font-family: 'Consolas', monospace; font-size: 10px; color: var(--hint); margin-top: 15px; text-align: left; background: #000; padding: 10px; border-radius: 5px; height: 50px; overflow: hidden; }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>SHADOWGRID // GLOBAL BEACON</h1>
        <div class="status" id="p2p-status">MESH_NETWORK: INITIALIZING...</div>
    </div>

    <div class="content">
        <!-- –ë–ª–æ–∫ 1: –û–ø–∏—Å–∞–Ω–∏–µ -->
        <div class="post">
            <h2>–û –ø—Ä–æ–µ–∫—Ç–µ</h2>
            <p>ShadowGrid (2026) ‚Äî —ç—Ç–æ DePIN-–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–æ–≤–æ–≥–æ –ø–æ–∫–æ–ª–µ–Ω–∏—è. –ú—ã –æ–±—ä–µ–¥–∏–Ω–∏–ª–∏ Mesh-—Å–µ—Ç–∏ –∏ —Ä—ã–Ω–æ–∫ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π, —á—Ç–æ–±—ã —Å–æ–∑–¥–∞—Ç—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø–æ–¥–≤–µ—Ä–≥–Ω—É—Ç—å —Ü–µ–Ω–∑—É—Ä–µ –∏–ª–∏ –æ—Ç–∫–ª—é—á–∏—Ç—å.</p>
            <ul>
                <li><b>–ê–Ω–æ–Ω–∏–º–Ω–æ—Å—Ç—å:</b> –ü–æ–ª–Ω–æ–µ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤.</li>
                <li><b>–ñ–∏–≤—É—á–µ—Å—Ç—å:</b> –†–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ Wi-Fi/Bluetooth —Å–æ—Å–µ–¥–µ–π –¥–∞–∂–µ –±–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞.</li>
                <li><b>–î–æ—Ö–æ–¥:</b> –í–∞—à –•–∞–± —Å–¥–∞–µ—Ç –º–æ—â–Ω–æ—Å—Ç—å –ø–æ–¥ –ò–ò-–∑–∞–¥–∞—á–∏ (PoUW), –ø–æ–∫–∞ –≤—ã —Å–ø–∏—Ç–µ.</li>
            </ul>
        </div>

        <!-- –ë–ª–æ–∫ 2: –ò–Ω–≤–µ—Å—Ç–æ—Ä–∞–º -->
        <div class="post">
            <h2>–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω–∞—è –ø—Ä–∏–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å</h2>
            <p>–í 2026 –≥–æ–¥—É –¥–∞–Ω–Ω—ã–µ –∏ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã–µ –º–æ—â–Ω–æ—Å—Ç–∏ ‚Äî —ç—Ç–æ –Ω–æ–≤–∞—è –Ω–µ—Ñ—Ç—å. ShadowGrid –º–æ–Ω–µ—Ç–∏–∑–∏—Ä—É–µ—Ç –∫–∞–∂–¥—ã–π —É–∑–µ–ª —Å–µ—Ç–∏:</p>
            <ul>
                <li>–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å: –ö–∞–∂–¥—ã–π –Ω–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–∞—Å—à–∏—Ä—è–µ—Ç —Å–µ—Ç—å, –∞ –Ω–µ –Ω–∞–≥—Ä—É–∂–∞–µ—Ç –µ—ë.</li>
                <li>–¢–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è: –ù–∞–≥—Ä–∞–¥—ã –∑–∞ –ø–æ–ª–µ–∑–Ω—É—é —Ä–∞–±–æ—Ç—É (Proof of Useful Work).</li>
                <li>–†—ã–Ω–æ–∫: –°–ø—Ä–æ—Å –Ω–∞ –¥–µ—Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –ò–ò-—Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ –≤—ã—Ä–æ—Å –Ω–∞ 400%.</li>
            </ul>
        </div>

        <!-- –ë–ª–æ–∫ 3: –î–æ—Ä–æ–∂–Ω–∞—è –∫–∞—Ä—Ç–∞ -->
        <div class="post">
            <h2>Roadmap 2026</h2>
            <div class="roadmap">
                <div class="step done">‚úÖ Q1: –ó–∞–ø—É—Å–∫ –ì–µ–Ω–µ–∑–∏—Å-–ú–∞—è–∫–æ–≤ –∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ —Å–≤—è–∑–∏.</div>
                <div class="step next">üîµ Q2: –í–Ω–µ–¥—Ä–µ–Ω–∏–µ –ò–ò-–º–∞–π–Ω–∏–Ω–≥–∞ (PoUW) –≤ –•–∞–±—ã.</div>
                <div class="step">‚ö™ Q3: –ú–æ–±–∏–ª—å–Ω—ã–µ Mesh-—É–∑–ª—ã (iOS/Android).</div>
                <div class="step">‚ö™ Q4: –ü–æ–ª–Ω–∞—è –∞–≤—Ç–æ–Ω–æ–º–Ω–æ—Å—Ç—å –æ—Ç –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ IP.</div>
            </div>
        </div>
    </div>

    <!-- –ó–æ–Ω–∞ –∑–∞–≥—Ä—É–∑–∫–∏ -->
    <div class="download-zone">
        <div id="main-msg" style="font-size: 14px; margin-bottom: 15px; font-weight: 500;">–û–∂–∏–¥–∞–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–∞ –ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä–∞...</div>
        <button id="dl-btn" class="btn-dl" disabled>–ü–†–û–í–ï–†–ö–ê –°–ò–ì–ù–ê–õ–ê...</button>
        <p style="font-size: 11px; color: var(--hint); margin-top: 10px;">–§–∞–π–ª –±—É–¥–µ—Ç –¥–æ—Å—Ç–∞–≤–ª–µ–Ω —á–µ—Ä–µ–∑ P2P Grid –Ω–∞–ø—Ä—è–º—É—é –æ—Ç —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ —Å–µ—Ç–∏.</p>
        <div id="console">System boot...</div>
    </div>
</div>

<script>
    const log = (t) => { document.getElementById('console').innerText = "> " + t; };

    async function init() {
        try {
            // 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–ª—é—á–∞ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞ (—á–µ—Ä–µ–∑ –≤–∞—à–µ —Ä—É–∫–æ–ø–æ–∂–∞—Ç–∏–µ)
            const response = await fetch('/api/get_key');
            const data = await response.json();
            const MASTER_KEY = data.pub_key;

            if (!MASTER_KEY) {
                document.getElementById('main-msg').innerText = "–ú–ê–Ø–ö –ù–ï –ê–ö–¢–ò–í–ò–†–û–í–ê–ù –ê–†–•–ò–¢–ï–ö–¢–û–†–û–ú";
                log("Awaiting Handshake from Admin app...");
                return;
            }

            log("Master Key verified. Connecting to GunDB...");
            document.getElementById('p2p-status').innerText = "MESH_NETWORK: ONLINE";

            // 2. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ç–∏
            const gun = Gun(['gun-manhattan.herokuapp.com']);
            
            // 3. –û–∂–∏–¥–∞–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∞–Ω–Ω–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞
            gun.get('shadowgrid').get('signal').on(async (signalData) => {
                if (!signalData) return;
                
                // –ö—Ä–∏–ø—Ç–æ-–ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏ –ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä–∞
                const verified = await Gun.SEA.verify(signalData, MASTER_KEY);
                
                if (verified) {
                    log("Signature Valid. Magnet link received.");
                    document.getElementById('main-msg').innerText = "–°–ò–ì–ù–ê–õ –í–ï–†–ò–§–ò–¶–ò–†–û–í–ê–ù. –°–ï–¢–¨ –î–û–°–¢–£–ü–ù–ê.";
                    document.getElementById('main-msg').style.color = "var(--success)";
                    
                    const btn = document.getElementById('dl-btn');
                    btn.innerText = "–°–ö–ê–ß–ê–¢–¨ –ê–í–¢–û–ù–û–ú–ù–´–ô –•–ê–ë (.EXE)";
                    btn.disabled = false;
                    
                    btn.onclick = () => {
                        const client = new WebTorrent();
                        log("Starting P2P download from Grid...");
                        client.add(verified.msg.magnet, (torrent) => {
                            const file = torrent.files.find(f => f.name.endsWith('.exe'));
                            file.getBlobURL((err, url) => {
                                const a = document.createElement('a');
                                a.href = url;
                                a.download = file.name;
                                a.click();
                                log("Download complete.");
                            });
                        });
                    };
                }
            });
        } catch (e) {
            log("Error: " + e.message);
        }
    }

    window.onload = init;
</script>
</body>
</html>
